/*! svg.draggable.js - v1.0.0 - 2015-06-12
* https://github.com/wout/svg.draggable.js
* Copyright (c) 2015 Wout Fierens; Licensed MIT */
(function(){SVG.extend(SVG.Element,{draggable:function(a,b,c){var d,e,f,g=this,h=this.parent(SVG.Nested)||this.parent(SVG.Doc),i={};return("function"==typeof a||"object"==typeof a)&&(b=a,a=!0),a=a===c?!0:a,b=b||{},g.remember("_draggable")?void g.remember("_draggable",b):(g.remember("_draggable",b),d=function(a){g.fire("beforedrag",{event:a});var b=g.bbox();g instanceof SVG.G?(b.x=g.x(),b.y=g.y()):g instanceof SVG.Nested&&(b=g.rbox()),i={event:a,position:{x:b.x,y:b.y,width:b.width,height:b.height,zoom:h.viewbox().zoom,rotation:g.transform().rotation*Math.PI/180}},SVG.on(window,"mousemove.drag",e),SVG.on(window,"mouseup.drag",f),g.fire("dragstart",i),a.preventDefault()},e=function(a){var b,c,d=g.remember("_draggable"),e=i.position.rotation,f=i.position.width,h=i.position.height,j={x:a.pageX-i.event.pageX,y:a.pageY-i.event.pageY,zoom:i.position.zoom};if(g.fire("dragmove",{delta:j,event:a}),b=i.position.x+(j.x*Math.cos(e)+j.y*Math.sin(e))/i.position.zoom,c=i.position.y+(j.y*Math.cos(e)+j.x*Math.sin(-e))/i.position.zoom,"function"==typeof d){var k=d.call(g,b,c);"boolean"==typeof k&&(k={x:k,y:k}),k.x===!0?g.x(b):k.x!==!1&&g.x(coords.x),k.y===!0?g.y(c):k.y!==!1&&g.y(coords.y)}else"object"==typeof d&&(null!=d.minX&&b<d.minX?b=d.minX:null!=d.maxX&&b>d.maxX-f&&(b=d.maxX-f),null!=d.minY&&c<d.minY?c=d.minY:null!=d.maxY&&c>d.maxY-h&&(c=d.maxY-h),g.move(b,c))},f=function(a){var b={x:a.pageX-i.event.pageX,y:a.pageY-i.event.pageY,zoom:i.position.zoom};SVG.off(window,"mousemove.drag",e),SVG.off(window,"mouseup.drag",f),g.fire("dragend",{delta:b,event:a})},a?(g.on("mousedown.drag",d),this):(g.off("mousedown.drag"),SVG.off(window,"mousemove.drag"),SVG.off(window,"mouseup.drag"),d=e=f=null,g.forget("_draggable"),this))}})}).call(this);